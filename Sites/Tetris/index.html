<!--
Tetris.

Copyright Joy Developing.
-->

<!DOCTYPE html>
<html>
    <head>
        <title>Tetris</title>
        <script src="../../JD/Utils.js"></script>
        <script src="../../JD/Drawer.js"></script>
        <script src="Board.js"></script>
        <script src="Figure.js"></script>
        <script>

<!--

// Drawer.
var D;

// Board.
var B;

// Figure.
var F;

//--------------------------------------------------------------------------------------------------

// Next step of game.
function Step()
{
    F = Figure.RandomFigure(5, 5, D);
    F.Autoposition(B.MaxRow, B.MinCol, B.MaxCol);
}

//--------------------------------------------------------------------------------------------------

// Redraw.
function Draw()
{
    B.Draw();

    if (F)
    {
        F.Draw();
    }
}

//--------------------------------------------------------------------------------------------------

// Load document.
function OnLoad()
{
    D = new Drawer("canvas", 10, 15, false, true);
    B = new Board(15, 10, D);

    Draw();
    JD.Utils.SetInterval
    (
        function()
        {
            Step();
            Draw();
        },
        "draw",
        1000
    );
}

//--------------------------------------------------------------------------------------------------

// Key down.
//
// Arguments:
//   e - event attributes.
function OnKeyDown(e)
{
    switch (e.keyCode)
    {
        case 39:
            OnRightArrowKeyDown();
            break;

        case 37:
            OnLeftArrowKeyDown();
            break;

        case 38:
            OnUpArrowKeyDown();
            break;

        case 40:
            OnDownArrowKeyDown();
            break;

        case 32:
            OnSpaceKeyDown();
            break;

        // No reaction on other keys down events.
        default:
            break;
    }
}

//--------------------------------------------------------------------------------------------------

// Right arrow key down.
function OnRightArrowKeyDown()
{
    alert("right arrow");
}

//--------------------------------------------------------------------------------------------------

// Left arrow key down.
function OnLeftArrowKeyDown()
{
    alert("left arrow");
}

//--------------------------------------------------------------------------------------------------

// Up arrow key down.
function OnUpArrowKeyDown()
{
    F.RotL();
    Draw();
}

//--------------------------------------------------------------------------------------------------

// Down arrow key down.
function OnDownArrowKeyDown()
{
    alert("down arrow");
}

//--------------------------------------------------------------------------------------------------

// Space key down.
function OnSpaceKeyDown()
{
    alert("space");
}

//--------------------------------------------------------------------------------------------------

-->

        </script>
    </head>
    <body onload="OnLoad()" onkeydown="OnKeyDown(event)">
        <canvas width="400" height="600" id="canvas"/>
    </body>
</html>

